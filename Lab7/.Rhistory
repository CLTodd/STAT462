geom_text(label=movies[c(5,6,102,67,99,90,17,15,89,31,62),]$Name, data=rvf.full.data[abs(rvf.full.data$resid)>=25,], mapping=aes(x=predicted, y=resid)) +
geom_point(data=rvf.full.data[abs(rvf.full.data$resid)<25,], mapping=aes(x=predicted, y=resid), color="blue") +
geom_hline(yintercept=0, lty=2, size=1)
ggplotly(unusual)
unusual <-
ggplot( ) +
geom_point(data=rvf.full.data[abs(rvf.full.data$resid)>=25,], mapping=aes(x=predicted, y=resid), color="green") +
geom_text(label=row.names(rvf.full.data[abs(rvf.full.data$resid)>=25,]), data=rvf.full.data[abs(rvf.full.data$resid)>=25,], mapping=aes(x=predicted, y=resid)) +
geom_point(data=rvf.full.data[abs(rvf.full.data$resid)<25,], mapping=aes(x=predicted, y=resid), color="blue") +
geom_hline(yintercept=0, lty=2, size=1)
ggplotly(unusual)
movies[c(68,92),]
movies[c(31,36),]
c <- ols_plot_cooksd_bar(mlm.full)
full.cooks <- ols_plot_cooksd_bar(mlm.full)
full.cooks <- ols_plot_cooksd_bar(mlm.full)
c <- ols_plot_resid_stand(mlm.full)
full.cooks$data
full.stand.resid <- ols_plot_resid_stand(mlm.full)
full.stand.resid <- ols_plot_resid_stand(mlm.full)
c <- ols_plot_resid_lev(mlm.full)
c$data
full.resid.lev <- ols_plot_resid_lev(mlm.full)
full.resid.lev <- ols_plot_resid_lev(mlm.full)
# Clear Workspace
rm(list = ls())
# Load Libraries
library(ggplot2)
library(skimr)
library(GGally)
#library(gridExtra)
library(corrplot)
library(olsrr)
# Read in Data
movies <- read.csv("HollywoodMovies2011.csv")
# Likely a test entry, not a real movie
# Hard to believe a movie with a domestic gross revenue of $10 billion yields no results from a quick Google search
movies[movies$RottenTomatoes<0,]
# Keep everything except this row
movies <- movies[-80,]
# Reset the row indexing so we don't have issues later
row.names(movies) <- NULL
skim(movies)
# Remove the `Names` row since it isn't numeric
#ggpairs(movies[,-1],ggplot2::aes(alpha=0.5))
matrix <- ggpairs(movies[,-1], ggplot2::aes(alpha=0.9), diag=list(continuous="bar"))
matrix
# A look at the movies we mentioned above
movies[movies$Name %in% c("The Girl With The Dragon Tattoo","Rio","The Adjustment Bureau"),]
ggcorr(movies[,-1], layout.exp=1, high="blue", low="red")
# Model all of the variables (except `Name`) as predictors of critical rating
mlm.full <- lm(RottenTomatoes~., data=movies[,-1])
summary(mlm.full)
c1 <- mlm.full$coefficients
# QQ Plot
ols_plot_resid_qq(mlm.full)
# Residuals vs Fits data
rvf.full <- ols_plot_resid_fit(mlm.full, print_plot = FALSE)
rvf.full.data <- rvf.full$data
# Histogram of Residuals
ggplot(rvf.full.data, aes(x=resid)) +
geom_histogram(aes(y=..density..), color="grey",fill="white", bins=30) +
geom_density(alpha=0.1, fill="blue",color="blue",lwd=1) +
xlab("Residuals") + ggtitle("Distribution of Residuals")
# Statistical Tests for normality of the residuals
ols_test_normality(mlm.full)
matrix
rvf.full
ols_vif_tol(mlm.full)
full.resid.lev <- ols_plot_resid_lev(mlm.full)
full.stand.resid <- ols_plot_resid_stand(mlm.full)
full.cooks <- ols_plot_cooksd_bar(mlm.full)
# Add the residual, leverage, and influence data to the movies data
movies$full.resid <- rvf.full.data$resid
movies$full.stud.resid <- full.resid.lev$data$rstudent
movies$full.stand.resid <- full.stand.resid$data$sdres
movies$full.lev <- full.resid.lev$data$leverage
movies$full.cooks <- full.cooks$data$cd
movies[c(90,102,68,92,31,36),]
# Highlighting points with large residuals on the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +
geom_point(data=movies[abs(movies$full.resid)>=25,],
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(movies[abs(movies$full.resid)>=25,]),
data=movies[abs(movies$full.resid)>=25,],
mapping=aes(x=full.fits, y=full.resid)) +
geom_point(data=movies[abs(movies$full.resid)<25,],
mapping=aes(x=full.fits, y=full.resid),
color="blue")
ggplotly(unusual)
# Add the residual, leverage, and influence data to the movies data
movies$full.resid <- rvf.full.data$resid
movies$full.stud.resid <- full.resid.lev$data$rstudent
movies$full.stand.resid <- full.stand.resid$data$sdres
movies$full.lev <- full.resid.lev$data$leverage
movies$full.cooks <- full.cooks$data$cd
movies$full.fits <- rvf.full.data$predicted
movies[c(90,102,68,92,31,36),]
# Highlighting points with large residuals on the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +
geom_point(data=movies[abs(movies$full.resid)>=25,],
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(movies[abs(movies$full.resid)>=25,]),
data=movies[abs(movies$full.resid)>=25,],
mapping=aes(x=full.fits, y=full.resid)) +
geom_point(data=movies[abs(movies$full.resid)<25,],
mapping=aes(x=full.fits, y=full.resid),
color="blue")
ggplotly(unusual)
# Highlighting points with large residuals on the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +
geom_point(data=movies[abs(movies$full.resid)>=25,],
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(movies[abs(movies$full.resid)>=25,]),
data=movies[abs(movies$full.resid)>=25,],
mapping=aes(x=full.fits, y=full.resid)) +
geom_point(data=movies[abs(movies$full.resid)<25,],
mapping=aes(x=full.fits, y=full.resid),
color="blue") +
xlab("Fits")+
ylab("Residuals")
ggtitle("Residuals vs Fits (full model)")
ggplotly(unusual)
# Add the residual, leverage, and influence data to the movies data
movies$full.resid <- rvf.full.data$resid
movies$full.stud.resid <- full.resid.lev$data$rstudent
movies$full.stand.resid <- full.stand.resid$data$sdres
movies$full.lev <- full.resid.lev$data$leverage
movies$full.cooks <- full.cooks$data$cd
movies$full.fits <- rvf.full.data$predicted
special.movies <- movies[c(90,102,68,92,31,36),]
special.movies
# Highlighting points with large residuals on the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +
geom_point(data=movies[-c(90,102,68,92,31,36),],
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(special.movies),
data=special.movies,
mapping=aes(x=full.fits, y=full.resid)) +
geom_point(data=movies[-c(90,102,68,92,31,36),],
mapping=aes(x=full.fits, y=full.resid),
color="blue") +
xlab("Fits")+
ylab("Residuals")
ggtitle("Residuals vs Fits (full model)")
ggplotly(unusual)
# Highlighting points with large residuals on the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +
geom_point(data=special.movies,
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(special.movies),
data=special.movies,
mapping=aes(x=full.fits, y=full.resid)) +
geom_point(data=movies[-c(90,102,68,92,31,36),],
mapping=aes(x=full.fits, y=full.resid),
color="blue") +
xlab("Fits")+
ylab("Residuals")
ggtitle("Residuals vs Fits (full model)")
ggplotly(unusual)
# Highlighting points with large residuals on the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +         # Plot y=0 line
geom_point(data=movies[-c(90,102,68,92,31,36),],  # Plot non-special movies in blue
mapping=aes(x=full.fits, y=full.resid),
color="blue") +
geom_point(data=special.movies,                   # Plot Special movies in green
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(special.movies),        # Label Special Movies
data=special.movies,
mapping=aes(x=full.fits, y=full.resid)) +
xlab("Fits")+
ylab("Residuals")
ggtitle("Residuals vs Fits (full model)")
ggplotly(unusual)
z <- lm(RottenTomatoes~.,movies[-c(90,102,68,92,31,36),-1])
summary(z)
names(movies)
z <- lm(RottenTomatoes~.,movies[-c(90,102,68,92,31,36),2:7])
summary(z)
z <- lm(RottenTomatoes~.,movies[-c(90,102,68,92,31,36),2:7])
summary(z)
summary(mlm.full)
z <- lm(RottenTomatoes~.,movies[-c(90,102),2:7])
summary(z)
summary(mlm.full)
t <- lm(RottenTomatoes~.,movies[-90,2:7])
u <- lm(RottenTomatoes~.,movies[-102,2:7])
v <- lm(RottenTomatoes~.,movies[-68,2:7])
w <- lm(RottenTomatoes~.,movies[-92,2:7])
x <- lm(RottenTomatoes~.,movies[-31,2:7])
y <- lm(RottenTomatoes~.,movies[-36,2:7])
summary(mlm.full)
summary(mlm.full)
ols_regress(mlm.full)
summary(mlm.full)
mlm.full$effects
mlm.full$terms
mlm.full$model
summary(mlm.full)
cormatrix <- ggcorr(movies[,-1], layout.exp=1, high="blue", low="red")
cormatrix <- ggcorr(movies[,-1], layout.exp=1, high="blue", low="red")
cormatrix <- ggcorr(movies[,-1], layout.exp=1, high="blue", low="red")
cormatrix
summary(mlm.full)
cormatrix
names(movies)
# Don't want to use the Name column or any of the columns we added during the outlier diagnostics
mlm.NoThea <- lm(RottenTomatoes ~ . -TheatersOpenWeek, movies[,2:7])
summary(mlm.NoThea)
round( c1[["DomesticGross"]],3 )
summary(mlm.full)
?compareLM
??compareLM
compareLM(mlm.full, mlm.NoThea)
library(rcompanion)
compareLM(mlm.full, mlm.NoThea)
AIC(mlm.full)
AICc(mlm.full)
compareLM(mlm.full, mlm.NoThea)[3:7]
compareLM(mlm.full, mlm.NoThea)
compareLM(mlm.full, mlm.NoThea)$Fit.criteria
compareLM(mlm.full, mlm.NoThea)$Fit.criteria[3:7]
compareLM(mlm.full, mlm.NoThea)$Fit.criteria[c(3:5,7)]
# Clear Workspace
rm(list = ls())
# Load Libraries
library(ggplot2)
library(skimr)
library(GGally)
library(rcompanion)
library(corrplot)
library(olsrr)
library(plotly)
# Read in Data
movies <- read.csv("HollywoodMovies2011.csv")
# Likely a test entry, not a real movie
# Hard to believe a movie with a domestic gross revenue of $10 billion yields no results from a quick Google search
movies[movies$RottenTomatoes<0,]
# Keep everything except this row
movies <- movies[-80,]
# Reset the row indexing so we don't have issues later
row.names(movies) <- NULL
skim(movies)
# Remove the `Names` row since it isn't numeric
#ggpairs(movies[,-1],ggplot2::aes(alpha=0.5))
matrix <- ggpairs(movies[,-1], ggplot2::aes(alpha=0.9), diag=list(continuous="bar"))
matrix
# A look at the movies we mentioned above
movies[movies$Name %in% c("The Girl With The Dragon Tattoo","Rio","The Adjustment Bureau"),]
cormatrix <- ggcorr(movies[,-1], layout.exp=1, high="blue", low="red")
cormatrix
# Model all of the variables (except `Name`) as predictors of critical rating
mlm.full <- lm(RottenTomatoes~., data=movies[,-1])
summary(mlm.full)
c1 <- mlm.full$coefficients
# QQ Plot
ols_plot_resid_qq(mlm.full)
# Residuals vs Fits data
rvf.full <- ols_plot_resid_fit(mlm.full, print_plot = FALSE)
rvf.full.data <- rvf.full$data
# Histogram of Residuals
ggplot(rvf.full.data, aes(x=resid)) +
geom_histogram(aes(y=..density..), color="grey",fill="white", bins=30) +
geom_density(alpha=0.1, fill="blue",color="blue",lwd=1) +
xlab("Residuals") + ggtitle("Distribution of Residuals")
# Statistical Tests for normality of the residuals
ols_test_normality(mlm.full)
matrix
rvf.full
ols_vif_tol(mlm.full)
full.resid.lev <- ols_plot_resid_lev(mlm.full)
full.stand.resid <- ols_plot_resid_stand(mlm.full)
full.cooks <- ols_plot_cooksd_bar(mlm.full)
# Add the residual, leverage, and influence data to the movies data
movies$full.resid <- rvf.full.data$resid
movies$full.stud.resid <- full.resid.lev$data$rstudent
movies$full.stand.resid <- full.stand.resid$data$sdres
movies$full.lev <- full.resid.lev$data$leverage
movies$full.cooks <- full.cooks$data$cd
movies$full.fits <- rvf.full.data$predicted
# Subset of the unusual movies
unusual.movies <- movies[c(90,102,68,92,31,36),]
# Highlighting points with large residuals a the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +         # Plot y=0 line
geom_point(data=movies[-c(90,102,68,92,31,36),],  # Plot non-special movies in blue
mapping=aes(x=full.fits, y=full.resid),
color="blue") +
geom_point(data=unusual.movies,                   # Plot Special movies in green
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(unusual.movies),        # Label Special Movies
data=unusual.movies,
mapping=aes(x=full.fits, y=full.resid)) +
xlab("Fits")+
ylab("Residuals")
ggtitle("Residuals vs Fits (full model)")
ggplotly(unusual) # Display plot
unusual.movies    # Display the unusual movie data
summary(mlm.full)
cormatrix
# Don't want to use the Name column or any of the columns we added during the outlier diagnostics
mlm.NoThea <- lm(RottenTomatoes ~ . -TheatersOpenWeek, movies[,2:7])
summary(mlm.NoThea)
compareLM(mlm.full, mlm.NoThea)$Fit.criteria[c(3:5,7)]
names(movies)
compareLM(mlm.full, mlm.NoThea)$Fit.criteria[c(3:7)]
compareLM(mlm.full, mlm.NoThea)$Fit.criteria[c(3:7,6)]
compareLM(mlm.full, mlm.NoThea)$Fit.criteria[c(3:5,7,6)]
View(movies)
View(movies)
# Create new movie as a new data frame
newmovie <- data.frame(Name              ="Hunt of the Killer Cactus",
AudienceScore     = 59,
TheatersOpenWeek  = 5,
BOAverageOpenWeek = 147262,
DomesticGross     = 16.38,
Profitability     = 88.31)
# 95% confidence interval fo rthe average critic rating on a 2011 movie from this studio
predict(mlm.NoThea, newdata = newmovie, interval="confidence", level=0.95)
# Create new movie as a new data frame
newmovie <- data.frame(Name              ="Hunt of the Killer Cactus",
AudienceScore     = 59,
TheatersOpenWeek  = 5,
BOAverageOpenWeek = 147262,
DomesticGross     = 16.38,
Profitability     = 88.31)
# 95% confidence interval fo rthe average critic rating on a 2011 movie from this studio
CI <- predict(mlm.NoThea, newdata = newmovie, interval="confidence", level=0.95)
CI
CI$lwr
CI["lwr"]
CI[2]
ols_step_best_subset(mlm.full)
?ols_step_best_subset
# Residuals vs Fits data
rvf.full <- ols_plot_resid_fit(mlm.full, print_plot = FALSE)
rvf.full.data <- rvf.full$data
# Histogram of Residuals
hist <-
ggplot(rvf.full.data, aes(x=resid)) +
geom_histogram(aes(y=..density..), color="grey",fill="white", bins=30) +
geom_density(alpha=0.1, fill="blue",color="blue",lwd=1) +
xlab("Residuals") + ggtitle("Distribution of Residuals")
# QQ Plot of residuals
ols_plot_resid_qq(mlm.full)
hist
# Add the residual, leverage, and influence data to the movies data
movies$full.resid <- rvf.full.data$resid
movies$full.stud.resid <- full.resid.lev$data$rstudent
movies$full.stand.resid <- full.stand.resid$data$sdres
movies$full.lev <- full.resid.lev$data$leverage
movies$full.cooks <- full.cooks$data$cd
movies$full.fits <- rvf.full.data$predicted
# Subset of the unusual movies
unusual.movies <- movies[c(90,102,68,92,31,36),]
# Highlighting points with large residuals on the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +         # Plot y=0 line
geom_point(data=movies[-c(90,102,68,92,31,36),],  # Plot non-special movies in blue
mapping=aes(x=full.fits, y=full.resid),
color="blue") +
geom_point(data=unusual.movies,                   # Plot Special movies in green
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(unusual.movies),        # Label Special Movies
data=unusual.movies,
mapping=aes(x=full.fits, y=full.resid)) +
xlab("Fits")+
ylab("Residuals")
ggtitle("Residuals vs Fits (full model)")
# Add the residual, leverage, and influence data to the movies data
movies$full.resid <- rvf.full.data$resid
movies$full.stud.resid <- full.resid.lev$data$rstudent
movies$full.stand.resid <- full.stand.resid$data$sdres
movies$full.lev <- full.resid.lev$data$leverage
movies$full.cooks <- full.cooks$data$cd
movies$full.fits <- rvf.full.data$predicted
# Subset of the unusual movies
unusual.movies <- movies[c(90,102,68,92,31,36),]
# Highlighting points with large residuals on the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +         # Plot y=0 line
geom_point(data=movies[-c(90,102,68,92,31,36),],  # Plot non-special movies in blue
mapping=aes(x=full.fits, y=full.resid),
color="blue") +
geom_point(data=unusual.movies,                   # Plot Special movies in green
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(unusual.movies),        # Label Special Movies
data=unusual.movies,
mapping=aes(x=full.fits, y=full.resid)) +
xlab("Fits")+
ylab("Residuals")
ggtitle("Residuals vs Fits (full model)")
# Add the residual, leverage, and influence data to the movies data
movies$full.resid <- rvf.full.data$resid
movies$full.stud.resid <- full.resid.lev$data$rstudent
movies$full.stand.resid <- full.stand.resid$data$sdres
movies$full.lev <- full.resid.lev$data$leverage
movies$full.cooks <- full.cooks$data$cd
movies$full.fits <- rvf.full.data$predicted
# Subset of the unusual movies
unusual.movies <- movies[c(90,102,68,92,31,36),]
# Highlighting points with large residuals on the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +         # Plot y=0 line
geom_point(data=movies[-c(90,102,68,92,31,36),],  # Plot non-special movies in blue
mapping=aes(x=full.fits, y=full.resid),
color="blue") +
geom_point(data=unusual.movies,                   # Plot Special movies in green
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(unusual.movies),        # Label Special Movies
data=unusual.movies,
mapping=aes(x=full.fits, y=full.resid)) +
xlab("Fits")+
ylab("Residuals")
ggtitle("Residuals vs Fits (full model)")
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +         # Plot y=0 line
geom_point(data=movies[-c(90,102,68,92,31,36),],  # Plot non-special movies in blue
mapping=aes(x=full.fits, y=full.resid),
color="blue") +
geom_point(data=unusual.movies,                   # Plot Special movies in green
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(unusual.movies),        # Label Special Movies
data=unusual.movies,
mapping=aes(x=full.fits, y=full.resid)) +
xlab("Fits")+
ylab("Residuals")
ggtitle("Residuals vs Fits (full model)")
# Add the residual, leverage, and influence data to the movies data
movies$full.resid <- rvf.full.data$resid
movies$full.stud.resid <- full.resid.lev$data$rstudent
movies$full.stand.resid <- full.stand.resid$data$sdres
movies$full.lev <- full.resid.lev$data$leverage
movies$full.cooks <- full.cooks$data$cd
movies$full.fits <- rvf.full.data$predicted
# Subset of the unusual movies
unusual.movies <- movies[c(90,102,68,92,31,36),]
# Highlighting points with large residuals on the Residuals vs Fits plot
unusual <-
ggplot( ) +
geom_hline(yintercept=0, lty=2, size=1) +         # Plot y=0 line
geom_point(data=movies[-c(90,102,68,92,31,36),],  # Plot non-special movies in blue
mapping=aes(x=full.fits, y=full.resid),
color="blue") +
geom_point(data=unusual.movies,                   # Plot Special movies in green
aes(x=full.fits, y=full.resid),
color="green") +
geom_text(label=row.names(unusual.movies),        # Label Special Movies
data=unusual.movies,
mapping=aes(x=full.fits, y=full.resid)) +
xlab("Fits")+
ylab("Residuals") +
ggtitle("Residuals vs Fits (full model)")
cormatrix <- ggcorr(movies[,-1], layout.exp=1, high="blue", low="white")
cormatrix
cormatrix <- ggcorr(movies[,-1], layout.exp=1, high="blue", low="white", mid="grey")
cormatrix
cormatrix <- ggcorr(movies[,-1], layout.exp=1, high="blue", low="white")
cormatrix
cormatrix <- ggcorr(movies[,-1], layout.exp=1, high="blue", low="orange")
cormatrix
cormatrix <- ggcorr(movies[,-1], layout.exp=1, high="blue", low="red")
cormatrix
# Don't want to use the Name column or any of the columns we added during the outlier diagnostics
mlm.NoThea <- lm(RottenTomatoes ~ . -TheatersOpenWeek, movies[,2:7])
ols_regress(mlm.NoThea)
# Don't want to use the Name column or any of the columns we added during the outlier diagnostics
mlm.NoThea <- lm(RottenTomatoes ~ . -TheatersOpenWeek, movies[,2:7])
ols_regress(mlm.NoThea)
c <- ols_step_best_subset(mlm.full)
c$mindex
c[,1:3]
c[1,]
c[1,1]
c[1,1:2]
c[1,2]
c[2,2]
c[1:10,]
c[10,]
library(pandos)
library(pandoc)
library(Pandoc)
install.packages("Pandoc")
install.packages("pandoc")
